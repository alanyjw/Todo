#! /bin/bash

set -ex

CURR_DIR=$(pwd)
SCHEME="Todo"
PROJECT="$CURR_DIR/Todo.xcodeproj"
TEST_SDK=${SDK:="iphoneos9.3"}
DESTINATION=${DEVICE_STRING:="platform=iOS,name=milo"}

cd $CURR_DIR

bundle

xcodebuild \
  -scheme $SCHEME \
  -project $PROJECT \
  -destination "$DESTINATION" \
  -sdk "$TEST_SDK" \
  clean build test \
  PROVISIONING_PROFILE=caebeb63-96b3-432f-80e9-c9cfa2c81f6c \
  # | xcpretty && exit ${PIPESTATUS[0]}
